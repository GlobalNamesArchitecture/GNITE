/*
 * jsTree 1.0-rc1
 * http://jstree.com/
 *
 * Copyright (c) 2010 Ivan Bozhanov (vakata.com)
 *
 * Dual licensed under the MIT and GPL licenses (same as jQuery):
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * $Date: 2010-07-01 10:51:11 +0300 (четв, 01 юли 2010) $
 * $Revision: 191 $
 */

/*jslint browser: true, onevar: true, undef: true, bitwise: true, strict: true */
/*global window : false, clearInterval: false, clearTimeout: false, document: false, setInterval: false, setTimeout: false, jQuery: false, navigator: false, XSLTProcessor: false, DOMParser: false, XMLSerializer: false*/

"use strict";
(function(c){c.vakata={};c.vakata.css={get_css:function(a,e,f){a=a.toLowerCase();var g=f.cssRules||f.rules,k=0;do{if(g.length&&k>g.length+5)break;if(g[k].selectorText&&g[k].selectorText.toLowerCase()==a)if(e===true){f.removeRule&&f.removeRule(k);f.deleteRule&&f.deleteRule(k);return true}else return g[k]}while(g[++k]);return false},add_css:function(a,e){if(c.jstree.css.get_css(a,false,e))return false;e.insertRule?e.insertRule(a+" { }",0):e.addRule(a,null,0);return c.vakata.css.get_css(a)},remove_css:function(a,
e){return c.vakata.css.get_css(a,true,e)},add_sheet:function(a){var e;if(a.str){e=document.createElement("style");e.setAttribute("type","text/css");if(e.styleSheet){document.getElementsByTagName("head")[0].appendChild(e);e.styleSheet.cssText=a.str}else{e.appendChild(document.createTextNode(a.str));document.getElementsByTagName("head")[0].appendChild(e)}return e.sheet||e.styleSheet}if(a.url)if(document.createStyleSheet)try{document.createStyleSheet(a.url)}catch(f){}else{e=document.createElement("link");
e.rel="stylesheet";e.type="text/css";e.media="all";e.href=a.url;document.getElementsByTagName("head")[0].appendChild(e);return e.styleSheet}}}})(jQuery);
(function(c){var a=[],e=-1,f={},g={},k=false;c.fn.jstree=function(b){var d=typeof b=="string",h=Array.prototype.slice.call(arguments,1),i=this;!d&&c.meta&&h.push(c.metadata.get(this).jstree);b=!d&&h.length?c.extend.apply(null,[true,b].concat(h)):b;if(d&&b.substring(0,1)=="_")return i;d?this.each(function(){var l=a[c.data(this,"jstree-instance-id")];l=l&&c.isFunction(l[b])?l[b].apply(l,h):l;if(typeof l!=="undefined"&&(b.indexOf("is_"===0)||l!==true&&l!==false)){i=l;return false}}):this.each(function(){var l=
c.data(this,"jstree-instance-id"),j=false;typeof l!=="undefined"&&a[l]&&a[l].destroy();l=parseInt(a.push({}),10)-1;c.data(this,"jstree-instance-id",l);b||(b={});b.plugins=c.isArray(b.plugins)?b.plugins:c.jstree.defaults.plugins;c.inArray("core",b.plugins)===-1&&b.plugins.unshift("core");j=c.extend(true,{},c.jstree.defaults,b);j.plugins=b.plugins;c.each(f,function(m){if(c.inArray(m,j.plugins)===-1){j[m]=null;delete j[m]}});a[l]=new c.jstree._instance(l,c(this).addClass("jstree jstree-"+l),j);c.each(a[l]._get_settings().plugins,
function(m,n){a[l].data[n]={}});c.each(a[l]._get_settings().plugins,function(m,n){f[n]&&f[n].__init.apply(a[l])});a[l].init()});return i};c.jstree={defaults:{plugins:[]},_focused:function(){return a[e]||null},_reference:function(b){if(a[b])return a[b];var d=c(b);if(!d.length&&typeof b==="string")d=c("#"+b);if(!d.length)return null;return a[d.closest(".jstree").data("jstree-instance-id")]||null},_instance:function(b,d,h){this.data={core:{}};this.get_settings=function(){return c.extend(true,{},h)};
this._get_settings=function(){return h};this.get_index=function(){return b};this.get_container=function(){return d};this._set_settings=function(i){h=c.extend(true,{},h,i)}},_fn:{},plugin:function(b,d){d=c.extend({},{__init:c.noop,__destroy:c.noop,_fn:{},defaults:false},d);f[b]=d;c.jstree.defaults[b]=d.defaults;c.each(d._fn,function(h,i){i.plugin=b;i.old=c.jstree._fn[h];c.jstree._fn[h]=function(){var l,j=i,m=Array.prototype.slice.call(arguments);l=new c.Event("before.jstree");var n=false;do{if(j&&
j.plugin&&c.inArray(j.plugin,this._get_settings().plugins)!==-1)break;j=j.old}while(j);if(j){l=this.get_container().triggerHandler(l,{func:h,inst:this,args:m});if(l!==false){if(typeof l!=="undefined")m=l;return l=h.indexOf("_")===0?j.apply(this,m):j.apply(c.extend({},this,{__callback:function(p){this.get_container().triggerHandler(h+".jstree",{inst:this,args:m,rslt:p,rlbk:n})},__rollback:function(){return n=this.get_rollback()},__call_old:function(p){return j.old.apply(this,p?Array.prototype.slice.call(arguments,
1):m)}}),m)}}};c.jstree._fn[h].old=i.old;c.jstree._fn[h].plugin=b})},rollback:function(b){if(b){c.isArray(b)||(b=[b]);c.each(b,function(d,h){a[h.i].set_rollback(h.h,h.d)})}}};c.jstree._fn=c.jstree._instance.prototype={};c(function(){var b=navigator.userAgent.toLowerCase(),d=(b.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],h=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";
if(/msie/.test(b)&&parseInt(d,10)==6){k=true;h+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}if(/msie/.test(b)&&
parseInt(d,10)==7)h+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } ";c.vakata.css.add_sheet({str:h})});c.jstree.plugin("core",{__init:function(){this.data.core.to_open=c.map(c.makeArray(this.get_settings().core.initially_open),function(b){return"#"+b.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")})},defaults:{html_titles:false,animation:500,initially_open:[],rtl:false,strings:{loading:"Loading ...",new_node:"New node"}},_fn:{init:function(){this.set_focus();
this._get_settings().core.rtl&&this.get_container().addClass("jstree-rtl").css("direction","rtl");this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_settings().core.strings.loading+"</a></li></ul>");this.data.core.li_height=this.get_container().find("ul li.jstree-closed, ul li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",c.proxy(function(b){var d=
c(b.target);d.is("ins")&&b.pageY-d.offset().top<this.data.core.li_height&&this.toggle_node(d)},this)).bind("mousedown.jstree",c.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(){var b;if(document.selection&&document.selection.empty)document.selection.empty();else if(window.getSelection){b=window.getSelection();try{b.removeAllRanges();b.collapse()}catch(d){}}});this.__callback();this.load_node(-1,function(){this.loaded();this.reopen()})},destroy:function(){var b,d=this.get_index(),
h=this._get_settings(),i=this;c.each(h.plugins,function(l,j){try{f[j].__destroy.apply(i)}catch(m){}});this.__callback();if(this.is_focused())for(b in a)if(a.hasOwnProperty(b)&&b!=d){a[b].set_focus();break}if(d===e)e=-1;this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree-instance-id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});a[d]=null;delete a[d]},save_opened:function(){var b=this;this.data.core.to_open=
[];this.get_container().find(".jstree-open").each(function(){b.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))});this.__callback(b.data.core.to_open)},reopen:function(b){var d=this,h=true,i=[],l=[];if(!b){this.data.core.reopen=false;this.data.core.refreshing=true}if(this.data.core.to_open.length){c.each(this.data.core.to_open,function(j,m){if(m=="#")return true;c(m).length&&c(m).is(".jstree-closed")?i.push(m):l.push(m)});if(i.length){this.data.core.to_open=
l;c.each(i,function(j,m){d.open_node(m,function(){d.reopen(true)},true)});h=false}}if(h){this.data.core.reopen&&clearTimeout(this.data.core.reopen);this.data.core.reopen=setTimeout(function(){d.__callback({},d)},50);this.data.core.refreshing=false}},refresh:function(b){var d=this;this.save_opened();b||(b=-1);(b=this._get_node(b))||(b=-1);b!==-1&&b.children("UL").remove();this.load_node(b,function(){d.__callback({obj:b});d.reopen()})},loaded:function(){this.__callback()},set_focus:function(){var b=
c.jstree._focused();b&&b!==this&&b.get_container().removeClass("jstree-focused");if(b!==this){this.get_container().addClass("jstree-focused");e=this.get_index()}this.__callback()},is_focused:function(){return e==this.get_index()},_get_node:function(b){var d=c(b,this.get_container());if(d.is(".jstree")||b==-1)return-1;d=d.closest("li",this.get_container());return d.length?d:false},_get_next:function(b,d){b=this._get_node(b);if(b===-1)return this.get_container().find("> ul > li:first-child");if(!b.length)return false;
if(d)return b.nextAll("li").size()>0?b.nextAll("li:eq(0)"):false;return b.hasClass("jstree-open")?b.find("li:eq(0)"):b.nextAll("li").size()>0?b.nextAll("li:eq(0)"):b.parentsUntil(".jstree","li").next("li").eq(0)},_get_prev:function(b,d){b=this._get_node(b);if(b===-1)return this.get_container().find("> ul > li:last-child");if(!b.length)return false;if(d)return b.prevAll("li").length>0?b.prevAll("li:eq(0)"):false;if(b.prev("li").length){for(b=b.prev("li").eq(0);b.hasClass("jstree-open");)b=b.children("ul:eq(0)").children("li:last");
return b}else{var h=b.parentsUntil(".jstree","li:eq(0)");return h.length?h:false}},_get_parent:function(b){b=this._get_node(b);if(b==-1||!b.length)return false;b=b.parentsUntil(".jstree","li:eq(0)");return b.length?b:-1},_get_children:function(b){b=this._get_node(b);if(b===-1)return this.get_container().children("ul:eq(0)").children("li");if(!b.length)return false;return b.children("ul:eq(0)").children("li")},get_path:function(b,d){var h=[],i=this;b=this._get_node(b);if(b===-1||!b||!b.length)return false;
b.parentsUntil(".jstree","li").each(function(){h.push(d?this.id:i.get_text(this))});h.reverse();h.push(d?b.attr("id"):this.get_text(b));return h},is_open:function(b){return(b=this._get_node(b))&&b!==-1&&b.hasClass("jstree-open")},is_closed:function(b){return(b=this._get_node(b))&&b!==-1&&b.hasClass("jstree-closed")},is_leaf:function(b){return(b=this._get_node(b))&&b!==-1&&b.hasClass("jstree-leaf")},open_node:function(b,d,h){b=this._get_node(b);if(!b.length)return false;if(!b.hasClass("jstree-closed")){d&&
d.call();return false}var i=h||k?0:this._get_settings().core.animation,l=this;if(this._is_loaded(b)){i&&b.children("ul").css("display","none");b.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading");i&&b.children("ul").stop(true).slideDown(i,function(){this.style.display=""});this.__callback({obj:b});d&&d.call()}else{b.children("a").addClass("jstree-loading");this.load_node(b,function(){l.open_node(b,d,h)},d)}},close_node:function(b,d){b=this._get_node(b);
var h=d||k?0:this._get_settings().core.animation;if(!b.length||!b.hasClass("jstree-open"))return false;h&&b.children("ul").attr("style","display:block !important");b.removeClass("jstree-open").addClass("jstree-closed");h&&b.children("ul").stop(true).slideUp(h,function(){this.style.display=""});this.__callback({obj:b})},toggle_node:function(b){b=this._get_node(b);if(b.hasClass("jstree-closed"))return this.open_node(b);if(b.hasClass("jstree-open"))return this.close_node(b)},open_all:function(b,d){b=
b?this._get_node(b):this.get_container();if(!b||b===-1)b=this.get_container();if(d)b=b.find("li.jstree-closed");else{d=b;b=b.is(".jstree-closed")?b.find("li.jstree-closed").andSelf():b.find("li.jstree-closed")}var h=this;b.each(function(){var i=this;h._is_loaded(this)?h.open_node(this,false,true):h.open_node(this,function(){h.open_all(i,d)},true)});d.find("li.jstree-closed").length===0&&this.__callback({obj:d})},close_all:function(b){var d=this;b=b?this._get_node(b):this.get_container();if(!b||b===
-1)b=this.get_container();b.find("li.jstree-open").andSelf().each(function(){d.close_node(this)});this.__callback({obj:b})},clean_node:function(b){b=b&&b!=-1?c(b):this.get_container();b=b.is("li")?b.find("li").andSelf():b.find("li");b.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");b.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:b})},
get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(true),d:this.data}},set_rollback:function(b,d){this.get_container().empty().append(b);this.data=d;this.__callback()},load_node:function(b){this.__callback({obj:b})},_is_loaded:function(){return true},create_node:function(b,d,h,i,l){b=this._get_node(b);d=typeof d==="undefined"?"last":d;var j=c("<li>"),m=this._get_settings().core,n;if(b!==-1&&!b.length)return false;if(!l&&!this._is_loaded(b)){this.load_node(b,
function(){this.create_node(b,d,h,i,true)});return false}this.__rollback();if(typeof h==="string")h={data:h};h||(h={});h.attr&&j.attr(h.attr);h.state&&j.addClass("jstree-"+h.state);if(!h.data)h.data=m.strings.new_node;if(!c.isArray(h.data)){n=h.data;h.data=[];h.data.push(n)}c.each(h.data,function(p,o){n=c("<a>");if(c.isFunction(o))o=o.call(this,h);if(typeof o=="string")n.attr("href","#")[m.html_titles?"html":"text"](o);else{if(!o.attr)o.attr={};if(!o.attr.href)o.attr.href="#";n.attr(o.attr)[m.html_titles?
"html":"text"](o.title);o.language&&n.addClass(o.language)}n.prepend("<ins class='jstree-icon'>&#160;</ins>");if(o.icon)o.icon.indexOf("/")===-1?n.children("ins").addClass(o.icon):n.children("ins").css("background","url('"+o.icon+"') center center no-repeat");j.append(n)});j.prepend("<ins class='jstree-icon'>&#160;</ins>");if(b===-1){b=this.get_container();if(d==="before")d="first";if(d==="after")d="last"}switch(d){case "before":b.before(j);n=this._get_parent(b);break;case "after":b.after(j);n=this._get_parent(b);
break;case "inside":case "first":b.children("ul").length||b.append("<ul>");b.children("ul").prepend(j);n=b;break;case "last":b.children("ul").length||b.append("<ul>");b.children("ul").append(j);n=b;break;default:b.children("ul").length||b.append("<ul>");d||(d=0);n=b.children("ul").children("li").eq(d);n.length?n.before(j):b.children("ul").append(j);n=b}if(n===-1||n.get(0)===this.get_container().get(0))n=-1;this.clean_node(n);this.__callback({obj:j,parent:n});i&&i.call(this,j);return j},get_text:function(b){b=
this._get_node(b);if(!b.length)return false;var d=this._get_settings().core.html_titles;b=b.children("a:eq(0)");if(d){b=b.clone();b.children("INS").remove();return b.html()}else{b=b.contents().filter(function(){return this.nodeType==3})[0];return b.nodeValue}},set_text:function(b,d){b=this._get_node(b);if(!b.length)return false;b=b.children("a:eq(0)");if(this._get_settings().core.html_titles){var h=b.children("INS").clone();b.html(d).prepend(h);this.__callback({obj:b,name:d});return true}else{b=b.contents().filter(function(){return this.nodeType==
3})[0];this.__callback({obj:b,name:d});return b.nodeValue=d}},rename_node:function(b,d){b=this._get_node(b);this.__rollback();b&&b.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))&&this.__callback({obj:b,name:d})},delete_node:function(b){b=this._get_node(b);if(!b.length)return false;this.__rollback();var d=this._get_parent(b),h=this._get_prev(b);b=b.remove();d!==-1&&d.find("> ul > li").length===0&&d.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");this.clean_node(d);
this.__callback({obj:b,prev:h});return b},prepare_move:function(b,d,h,i,l){var j={};j.ot=c.jstree._reference(j.o)||this;j.o=j.ot._get_node(b);j.r=d===-1?-1:this._get_node(d);j.p=typeof j==="undefined"?"last":h;if(!(!l&&g.o&&g.o[0]===j.o[0]&&g.r[0]===j.r[0]&&g.p===j.p)){j.ot=c.jstree._reference(j.o)||this;j.rt=d===-1?j.ot:c.jstree._reference(j.r)||this;if(j.r===-1){j.cr=-1;switch(j.p){case "first":case "before":case "inside":j.cp=0;break;case "after":case "last":j.cp=j.rt.get_container().find(" > ul > li").length;
break;default:j.cp=j.p}}else{if(!/^(before|after)$/.test(j.p)&&!this._is_loaded(j.r))return this.load_node(j.r,function(){this.prepare_move(b,d,h,i,true)});switch(j.p){case "before":j.cp=j.r.index();j.cr=j.rt._get_parent(j.r);break;case "after":j.cp=j.r.index()+1;j.cr=j.rt._get_parent(j.r);break;case "inside":case "first":j.cp=0;j.cr=j.r;break;case "last":j.cp=j.r.find(" > ul > li").length;j.cr=j.r;break;default:j.cp=j.p;j.cr=j.r}}j.np=j.cr==-1?j.rt.get_container():j.cr;j.op=j.ot._get_parent(j.o);
j.or=j.np.find(" > ul > li:nth-child("+(j.cp+1)+")");g=j}this.__callback(g);i&&i.call(this,g)},check_move:function(){var b=g,d=true;if(b.or[0]===b.o[0])return false;b.o.each(function(){if(b.r.parentsUntil(".jstree").andSelf().filter("li").index(this)!==-1)return d=false});return d},move_node:function(b,d,h,i,l,j){if(!l)return this.prepare_move(b,d,h,function(n){this.move_node(n,false,false,i,true,j)});if(!j&&!this.check_move())return false;this.__rollback();d=false;if(i){d=b.o.clone();d.find("*[id]").andSelf().each(function(){if(this.id)this.id=
"copy_"+this.id})}else d=b.o;if(b.or.length)b.or.before(d);else{b.np.children("ul").length||c("<ul>").appendTo(b.np);b.np.children("ul:eq(0)").append(d)}try{b.ot.clean_node(b.op);b.rt.clean_node(b.np);b.op.find("> ul > li").length||b.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}catch(m){}if(i){g.cy=true;g.oc=d}this.__callback(g);return g},_get_move:function(){return g}}})})(jQuery);
(function(c){c.jstree.plugin("ui",{__init:function(){this.data.ui.selected=c();this.data.ui.last_selected=false;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",c.proxy(function(a){a.preventDefault();this.select_node(a.currentTarget,true,a)},this)).delegate("a","mouseenter.jstree",c.proxy(function(a){this.hover_node(a.target)},this)).delegate("a","mouseleave.jstree",c.proxy(function(a){this.dehover_node(a.target)},
this)).bind("reopen.jstree",c.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",c.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",c.proxy(function(){this.reselect()},this)).bind("close_node.jstree",c.proxy(function(a,e){var f=this._get_settings().ui,g=this._get_node(e.rslt.obj),k=g&&g.length?g.children("ul").find(".jstree-clicked"):c(),b=this;f.selected_parent_close===false||!k.length||k.each(function(){b.deselect_node(this);f.selected_parent_close===
"select_parent"&&b.select_node(g)})},this)).bind("delete_node.jstree",c.proxy(function(a,e){var f=this._get_settings().ui.select_prev_on_delete,g=this._get_node(e.rslt.obj);g=g&&g.length?g.find(".jstree-clicked"):[];var k=this;g.each(function(){k.deselect_node(this)});f&&g.length&&this.select_node(e.rslt.prev)},this)).bind("move_node.jstree",c.proxy(function(a,e){e.rslt.cy&&e.rslt.oc.find(".jstree-clicked").removeClass("jstree-clicked")},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",
selected_parent_close:"select_parent",select_prev_on_delete:true,disable_selecting_children:false,initially_select:[]},_fn:{_get_node:function(a,e){if(typeof a==="undefined"||a===null)return e?this.data.ui.selected:this.data.ui.last_selected;var f=c(a,this.get_container());if(f.is(".jstree")||a==-1)return-1;f=f.closest("li",this.get_container());return f.length?f:false},save_selected:function(){var a=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){a.data.ui.to_select.push("#"+
this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))});this.__callback(this.data.ui.to_select)},reselect:function(){var a=this,e=this.data.ui.to_select;e=c.map(c.makeArray(e),function(f){return"#"+f.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")});this.deselect_all();c.each(e,function(f,g){g&&g!=="#"&&a.select_node(g)});this.__callback()},refresh:function(){this.save_selected();return this.__call_old()},hover_node:function(a){a=this._get_node(a);if(!a.length)return false;
a.hasClass("jstree-hovered")||this.dehover_node();this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent();this.__callback({obj:a})},dehover_node:function(){var a=this.data.ui.hovered;if(!a||!a.length)return false;if(this.data.ui.hovered[0]===a.children("a").removeClass("jstree-hovered").parent()[0])this.data.ui.hovered=null;this.__callback({obj:a})},select_node:function(a,e,f){a=this._get_node(a);if(a==-1||!a||!a.length)return false;var g=this._get_settings().ui;f=g.select_multiple_modifier==
"on"||g.select_multiple_modifier!==false&&f&&f[g.select_multiple_modifier+"Key"];var k=this.is_selected(a),b=true;if(e){if(g.disable_selecting_children&&f&&a.parents("li",this.get_container()).children(".jstree-clicked").length)return false;b=false;switch(true){case k&&!f:this.deselect_all();k=false;b=true;break;case !k&&!f:if(g.select_limit==-1||g.select_limit>0){this.deselect_all();b=true}break;case k&&f:this.deselect_node(a);break;case !k&&f:if(g.select_limit==-1||this.data.ui.selected.length+
1<=g.select_limit)b=true}}if(b&&!k){a.children("a").addClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.add(a);this.data.ui.last_selected=a;this.__callback({obj:a})}},deselect_node:function(a){a=this._get_node(a);if(!a.length)return false;if(this.is_selected(a)){a.children("a").removeClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.not(a);if(this.data.ui.last_selected.get(0)===a.get(0))this.data.ui.last_selected=this.data.ui.selected.eq(0);this.__callback({obj:a})}},
toggle_select:function(a){a=this._get_node(a);if(!a.length)return false;this.is_selected(a)?this.deselect_node(a):this.select_node(a)},is_selected:function(a){return this.data.ui.selected.index(this._get_node(a))>=0},get_selected:function(a){return a?c(a).find(".jstree-clicked").parent():this.data.ui.selected},deselect_all:function(a){a?c(a).find(".jstree-clicked").removeClass("jstree-clicked"):this.get_container().find(".jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=c([]);
this.data.ui.last_selected=false;this.__callback()}}});c.jstree.defaults.plugins.push("ui")})(jQuery);
(function(c){c.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",c.proxy(function(a,e){if(this._get_settings().crrm.move.open_onmove){var f=this;e.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){f.open_node(this,false,true)})}},this))},defaults:{input_width_limit:200,move:{always_copy:false,open_onmove:true,default_position:"last",check_move:function(){return true}}},_fn:{_show_input:function(a,e){a=this._get_node(a);var f=this._get_settings().core.rtl,
g=this._get_settings().crrm.input_width_limit,k=a.children("ins").width(),b=a.find("> a:visible > ins").width()*a.find("> a:visible > ins").length,d=this.get_text(a),h=c("<div>",{css:{position:"absolute",top:"-200px",left:f?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),i=a.css("position","relative").append(c("<input>",{value:d,css:{padding:"0",border:"1px solid silver",position:"absolute",left:f?"auto":k+b+4+"px",right:f?k+b+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",
lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:c.proxy(function(){var l=a.children("input"),j=l.val();if(j==="")j=d;l.remove();this.set_text(a,d);this.rename_node(a,j);e.call(this,a,j,d);a.css("position","")},this),keyup:function(l){l=l.keyCode||l.which;if(l==27){this.value=d;this.blur()}else l==13?this.blur():i.width(Math.min(h.text("pW"+this.value).width(),g))}})).children("input");this.set_text(a,"");h.css({fontFamily:i.css("fontFamily")||"",fontSize:i.css("fontSize")||"",fontWeight:i.css("fontWeight")||
"",fontStyle:i.css("fontStyle")||"",fontStretch:i.css("fontStretch")||"",fontVariant:i.css("fontVariant")||"",letterSpacing:i.css("letterSpacing")||"",wordSpacing:i.css("wordSpacing")||""});i.width(Math.min(h.text("pW"+i[0].value).width(),g))[0].select()},rename:function(a){a=this._get_node(a);this.__rollback();var e=this.__callback;this._show_input(a,function(f,g,k){e.call(this,{obj:f,new_name:g,old_name:k})})},create:function(a,e,f,g,k){var b=this;(a=this._get_node(a))||(a=-1);this.__rollback();
return this.create_node(a,e,f,function(d){var h=this._get_parent(d),i=c(d).index();g&&g.call(this,d);h.length&&h.hasClass("jstree-closed")&&this.open_node(h,false,true);k?b.__callback({obj:d,name:this.get_text(d),parent:h,position:i}):this._show_input(d,function(l,j){b.__callback({obj:l,name:j,parent:h,position:i})})})},remove:function(a){a=this._get_node(a,true);this.__rollback();this.delete_node(a);this.__callback({obj:a})},check_move:function(){if(!this.__call_old())return false;if(!this._get_settings().crrm.move.check_move.call(this,
this._get_move()))return false;return true},move_node:function(a,e,f,g,k,b){var d=this._get_settings().crrm.move;if(!k){if(!f)f=d.default_position;if(f==="inside"&&!d.default_position.match(/^(before|after)$/))f=d.default_position;return this.__call_old(true,a,e,f,g,false,b)}if(d.always_copy===true||d.always_copy==="multitree"&&a.rt.get_index()!==a.ot.get_index())g=true;this.__call_old(true,a,e,f,g,true,b)},cut:function(a){a=this._get_node(a);this.data.crrm.cp_nodes=false;this.data.crrm.ct_nodes=
false;if(!a||!a.length)return false;this.data.crrm.ct_nodes=a},copy:function(a){a=this._get_node(a);this.data.crrm.cp_nodes=false;this.data.crrm.ct_nodes=false;if(!a||!a.length)return false;this.data.crrm.cp_nodes=a},paste:function(a){a=this._get_node(a);if(!a||!a.length)return false;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes)return false;this.data.crrm.ct_nodes&&this.move_node(this.data.crrm.ct_nodes,a);this.data.crrm.cp_nodes&&this.move_node(this.data.crrm.cp_nodes,a,false,true);this.data.crrm.cp_nodes=
false;this.data.crrm.ct_nodes=false}}});c.jstree.defaults.plugins.push("crrm")})(jQuery);
(function(c){var a=[];c.jstree._themes=false;c.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",c.proxy(function(){var e=this._get_settings().themes;this.data.themes.dots=e.dots;this.data.themes.icons=e.icons;this.set_theme(e.theme,e.url)},this)).bind("loaded.jstree",c.proxy(function(){this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons()},this))},defaults:{theme:"default",url:false,dots:true,icons:true},
_fn:{set_theme:function(e,f){if(!e)return false;f||(f=c.jstree._themes+e+"/style.css");if(c.inArray(f,a)==-1){c.vakata.css.add_sheet({url:f,rel:"jstree"});a.push(f)}if(this.data.themes.theme!=e){this.get_container().removeClass("jstree-"+this.data.themes.theme);this.data.themes.theme=e}this.get_container().addClass("jstree-"+e);this.data.themes.dots?this.show_dots():this.hide_dots();this.data.themes.icons?this.show_icons():this.hide_icons();this.__callback()},get_theme:function(){return this.data.themes.theme},
show_dots:function(){this.data.themes.dots=true;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=false;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){this.data.themes.dots?this.hide_dots():this.show_dots()},show_icons:function(){this.data.themes.icons=true;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=false;this.get_container().children("ul").addClass("jstree-no-icons")},
toggle_icons:function(){this.data.themes.icons?this.hide_icons():this.show_icons()}}});c(function(){c.jstree._themes===false&&c("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/)){c.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/";return false}});if(c.jstree._themes===false)c.jstree._themes="themes/"});c.jstree.defaults.plugins.push("themes")})(jQuery);
(function(c){c.jstree.plugin("json_data",{defaults:{data:false,ajax:false,correct_state:true,progressive_render:false},_fn:{load_node:function(a,e,f){var g=this;this.load_node_json(a,function(){g.__callback({obj:a});e.call(this)},f)},_is_loaded:function(a){var e=this._get_settings().json_data;if((a=this._get_node(a))&&a!==-1&&e.progressive_render&&!a.is(".jstree-open, .jstree-leaf")&&a.children("ul").children("li").length===0&&a.data("jstree-children")){if(e=this._parse_json(a.data("jstree-children"))){a.append(e);
c.removeData(a,"jstree-children")}this.clean_node(a);return true}return a==-1||!a||!e.ajax||a.is(".jstree-open, .jstree-leaf")||a.children("ul").children("li").size()>0},load_node_json:function(a,e,f){var g=this.get_settings().json_data,k,b=function(){};k=function(){};if((a=this._get_node(a))&&a!==-1)if(a.data("jstree-is-loading"))return;else a.data("jstree-is-loading",true);switch(true){case !g.data&&!g.ajax:throw"Neither data nor ajax settings supplied.";case !!g.data&&!g.ajax||!!g.data&&!!g.ajax&&
(!a||a===-1):if(!a||a==-1)if(k=this._parse_json(g.data)){this.get_container().children("ul").empty().append(k.children());this.clean_node()}else g.correct_state&&this.get_container().children("ul").empty();e&&e.call(this);break;case !g.data&&!!g.ajax||!!g.data&&!!g.ajax&&a&&a!==-1:b=function(d,h,i){var l=this.get_settings().json_data.ajax.error;l&&l.call(this,d,h,i);if(a!=-1&&a.length){a.children(".jstree-loading").removeClass("jstree-loading");a.data("jstree-is-loading",false);h==="success"&&g.correct_state&&
a.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")}else h==="success"&&g.correct_state&&this.get_container().children("ul").empty();f&&f.call(this)};k=function(d,h,i){var l=this.get_settings().json_data.ajax.success;if(l)d=l.call(this,d,h,i)||d;if(d===""||!c.isArray(d)&&!c.isPlainObject(d))return b.call(this,i,h,"");if(d=this._parse_json(d)){if(a===-1||!a)this.get_container().children("ul").empty().append(d.children());else{a.append(d).children(".jstree-loading").removeClass("jstree-loading");
a.data("jstree-is-loading",false)}this.clean_node(a);e&&e.call(this)}else if(a===-1||!a){if(g.correct_state){this.get_container().children("ul").empty();e&&e.call(this)}}else{a.children(".jstree-loading").removeClass("jstree-loading");a.data("jstree-is-loading",false);if(g.correct_state){a.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");e&&e.call(this)}}};g.ajax.context=this;g.ajax.error=b;g.ajax.success=k;if(!g.ajax.dataType)g.ajax.dataType="json";if(c.isFunction(g.ajax.url))g.ajax.url=
g.ajax.url.call(this,a);if(c.isFunction(g.ajax.data))g.ajax.data=g.ajax.data.call(this,a);c.ajax(g.ajax)}},_parse_json:function(a,e){var f=false,g=this._get_settings(),k=g.json_data,b=g.core.html_titles,d;if(!a)return f;if(c.isFunction(a))a=a.call(this);if(c.isArray(a)){f=c();if(!a.length)return false;g=0;for(k=a.length;g<k;g++){d=this._parse_json(a[g],true);if(d.length)f=f.add(d)}}else{if(typeof a=="string")a={data:a};if(!a.data&&a.data!=="")return f;f=c("<li>");a.attr&&f.attr(a.attr);a.metadata&&
f.data("jstree",a.metadata);a.state&&f.addClass("jstree-"+a.state);if(!c.isArray(a.data)){d=a.data;a.data=[];a.data.push(d)}c.each(a.data,function(h,i){d=c("<a>");if(c.isFunction(i))i=i.call(this,a);if(typeof i=="string")d.attr("href","#")[b?"html":"text"](i);else{if(!i.attr)i.attr={};if(!i.attr.href)i.attr.href="#";d.attr(i.attr)[b?"html":"text"](i.title);i.language&&d.addClass(i.language)}d.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!i.icon&&a.icon)i.icon=a.icon;if(i.icon)i.icon.indexOf("/")===
-1?d.children("ins").addClass(i.icon):d.children("ins").css("background","url('"+i.icon+"') center center no-repeat");f.append(d)});f.prepend("<ins class='jstree-icon'>&#160;</ins>");if(a.children)if(k.progressive_render&&a.state!=="open")f.addClass("jstree-closed").data("jstree-children",a.children);else{if(c.isFunction(a.children))a.children=a.children.call(this,a);if(c.isArray(a.children)&&a.children.length){d=this._parse_json(a.children,true);if(d.length){g=c("<ul>");g.append(d);f.append(g)}}}}if(!e){g=
c("<ul>");g.append(f);f=g}return f},get_json:function(a,e,f,g){var k=[],b=this._get_settings(),d=this,h,i,l,j,m,n;a=this._get_node(a);if(!a||a===-1)a=this.get_container().find("> ul > li");e=c.isArray(e)?e:["id","class"];!g&&this.data.types&&e.push(b.types.type_attr);f=c.isArray(f)?f:[];a.each(function(){l=c(this);h={data:[]};if(e.length)h.attr={};c.each(e,function(p,o){if((i=l.attr(o))&&i.length&&i.replace(/jstree[^ ]*|$/ig,"").length)h.attr[o]=i.replace(/jstree[^ ]*|$/ig,"")});if(l.hasClass("jstree-open"))h.state=
"open";if(l.hasClass("jstree-closed"))h.state="closed";j=l.children("a");j.each(function(){m=c(this);if(f.length||c.inArray("languages",b.plugins)!==-1||m.children("ins").get(0).style.backgroundImage.length||m.children("ins").get(0).className&&m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length){n=false;c.inArray("languages",b.plugins)!==-1&&c.isArray(b.languages)&&b.languages.length&&c.each(b.languages,function(p,o){if(m.hasClass(o)){n=o;return false}});i={attr:{},title:d.get_text(m,
n)};c.each(f,function(p,o){h.attr[o]=(m.attr(o)||"").replace(/jstree[^ ]*|$/ig,"")});c.each(b.languages,function(p,o){if(m.hasClass(o)){i.language=o;return true}});if(m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length)i.icon=m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"");if(m.children("ins").get(0).style.backgroundImage.length)i.icon=m.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")}else i=
d.get_text(m);if(j.length>1)h.data.push(i);else h.data=i});l=l.find("> ul > li");if(l.length)h.children=d.get_json(l,e,f,true);k.push(h)});return k}}})})(jQuery);
(function(c){c.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",c.proxy(function(a,e){var f=this._get_node(e.rslt.obj);f=f===-1?this.get_container().children("ul"):f.children("ul");this.sort(f)},this)).bind("rename_node.jstree",c.proxy(function(a,e){this.sort(e.rslt.obj.parent())},this)).bind("move_node.jstree",c.proxy(function(a,e){this.sort((e.rslt.np==-1?this.get_container():e.rslt.np).children("ul"))},this))},defaults:function(a,e){return this.get_text(a)>this.get_text(e)?
1:-1},_fn:{sort:function(a){var e=this._get_settings().sort,f=this;a.append(c.makeArray(a.children("li")).sort(c.proxy(e,f)));a.find("> li > ul").each(function(){f.sort(c(this))});this.clean_node(a)}}})})(jQuery);
(function(c){var a=false,e=false,f=false,g=false,k=false,b=false,d=false;c.vakata.dnd={is_down:false,is_drag:false,helper:false,scroll_spd:10,init_x:0,init_y:0,threshold:5,user_data:{},drag_start:function(h,i,l){c.vakata.dnd.is_drag&&c.vakata.drag_stop({});try{h.currentTarget.unselectable="on";h.currentTarget.onselectstart=function(){return false};if(h.currentTarget.style)h.currentTarget.style.MozUserSelect="none"}catch(j){}c.vakata.dnd.init_x=h.pageX;c.vakata.dnd.init_y=h.pageY;c.vakata.dnd.user_data=
i;c.vakata.dnd.is_down=true;c.vakata.dnd.helper=c("<div id='vakata-dragged'>").html(l).css("opacity","0.75");c(document).bind("mousemove",c.vakata.dnd.drag);c(document).bind("mouseup",c.vakata.dnd.drag_stop);return false},drag:function(h){if(c.vakata.dnd.is_down){if(!c.vakata.dnd.is_drag)if(Math.abs(h.pageX-c.vakata.dnd.init_x)>5||Math.abs(h.pageY-c.vakata.dnd.init_y)>5){c.vakata.dnd.helper.appendTo("body");c.vakata.dnd.is_drag=true;c(document).triggerHandler("drag_start.vakata",{event:h,data:c.vakata.dnd.user_data})}else return;
if(h.type==="mousemove"){var i=c(document),l=i.scrollTop();i=i.scrollLeft();if(h.pageY-l<20){if(k&&b==="down"){clearInterval(k);k=false}if(!k){b="up";k=setInterval(function(){c(document).scrollTop(c(document).scrollTop()-c.vakata.dnd.scroll_spd)},150)}}else if(k&&b==="up"){clearInterval(k);k=false}if(c(window).height()-(h.pageY-l)<20){if(k&&b==="up"){clearInterval(k);k=false}if(!k){b="down";k=setInterval(function(){c(document).scrollTop(c(document).scrollTop()+c.vakata.dnd.scroll_spd)},150)}}else if(k&&
b==="down"){clearInterval(k);k=false}if(h.pageX-i<20){if(g&&d==="right"){clearInterval(g);g=false}if(!g){d="left";g=setInterval(function(){c(document).scrollLeft(c(document).scrollLeft()-c.vakata.dnd.scroll_spd)},150)}}else if(g&&d==="left"){clearInterval(g);g=false}if(c(window).width()-(h.pageX-i)<20){if(g&&d==="left"){clearInterval(g);g=false}if(!g){d="right";g=setInterval(function(){c(document).scrollLeft(c(document).scrollLeft()+c.vakata.dnd.scroll_spd)},150)}}else if(g&&d==="right"){clearInterval(g);
g=false}}c.vakata.dnd.helper.css({left:h.pageX+5+"px",top:h.pageY+10+"px"});c(document).triggerHandler("drag.vakata",{event:h,data:c.vakata.dnd.user_data})}},drag_stop:function(h){c(document).unbind("mousemove",c.vakata.dnd.drag);c(document).unbind("mouseup",c.vakata.dnd.drag_stop);c(document).triggerHandler("drag_stop.vakata",{event:h,data:c.vakata.dnd.user_data});c.vakata.dnd.helper.remove();c.vakata.dnd.init_x=0;c.vakata.dnd.init_y=0;c.vakata.dnd.user_data={};c.vakata.dnd.is_down=false;c.vakata.dnd.is_drag=
false}};c(function(){c.vakata.css.add_sheet({str:"#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } "})});c.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:false,after:false,inside:false,before:false,off:false,prepared:false,w:0,to1:false,to2:false,cof:false,cw:false,ch:false,i1:false,i2:false};this.get_container().bind("mouseenter.jstree",c.proxy(function(){if(c.vakata.dnd.is_drag&&c.vakata.dnd.user_data.jstree&&
this.data.themes){f.attr("class","jstree-"+this.data.themes.theme);c.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}},this)).bind("mouseleave.jstree",c.proxy(function(){if(c.vakata.dnd.is_drag&&c.vakata.dnd.user_data.jstree){this.data.dnd.i1&&clearInterval(this.data.dnd.i1);this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).bind("mousemove.jstree",c.proxy(function(i){if(c.vakata.dnd.is_drag&&c.vakata.dnd.user_data.jstree){var l=this.get_container()[0];if(i.pageX+
24>this.data.dnd.cof.left+this.data.dnd.cw){this.data.dnd.i1&&clearInterval(this.data.dnd.i1);this.data.dnd.i1=setInterval(c.proxy(function(){this.scrollLeft+=c.vakata.dnd.scroll_spd},l),100)}else if(i.pageX-24<this.data.dnd.cof.left){this.data.dnd.i1&&clearInterval(this.data.dnd.i1);this.data.dnd.i1=setInterval(c.proxy(function(){this.scrollLeft-=c.vakata.dnd.scroll_spd},l),100)}else this.data.dnd.i1&&clearInterval(this.data.dnd.i1);if(i.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch){this.data.dnd.i2&&
clearInterval(this.data.dnd.i2);this.data.dnd.i2=setInterval(c.proxy(function(){this.scrollTop+=c.vakata.dnd.scroll_spd},l),100)}else if(i.pageY-24<this.data.dnd.cof.top){this.data.dnd.i2&&clearInterval(this.data.dnd.i2);this.data.dnd.i2=setInterval(c.proxy(function(){this.scrollTop-=c.vakata.dnd.scroll_spd},l),100)}else this.data.dnd.i2&&clearInterval(this.data.dnd.i2)}},this)).delegate("a","mousedown.jstree",c.proxy(function(i){if(i.which===1){this.start_drag(i.currentTarget,i);return false}},this)).delegate("a",
"mouseenter.jstree",c.proxy(function(i){c.vakata.dnd.is_drag&&c.vakata.dnd.user_data.jstree&&this.dnd_enter(i.currentTarget)},this)).delegate("a","mousemove.jstree",c.proxy(function(i){if(c.vakata.dnd.is_drag&&c.vakata.dnd.user_data.jstree){if(typeof this.data.dnd.off.top==="undefined")this.data.dnd.off=c(i.target).offset();this.data.dnd.w=(i.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height;if(this.data.dnd.w<0)this.data.dnd.w+=this.data.core.li_height;this.dnd_show()}},this)).delegate("a",
"mouseleave.jstree",c.proxy(function(i){if(c.vakata.dnd.is_drag&&c.vakata.dnd.user_data.jstree){this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;c.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");f.hide();if(e&&e[0]===i.target.parentNode){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);this.data.dnd.to1=false}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);this.data.dnd.to2=false}}}},this)).delegate("a","mouseup.jstree",c.proxy(function(i){c.vakata.dnd.is_drag&&
c.vakata.dnd.user_data.jstree&&this.dnd_finish(i)},this));c(document).bind("drag_stop.vakata",c.proxy(function(){this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;this.data.dnd.off=false;this.data.dnd.prepared=false;this.data.dnd.w=false;this.data.dnd.to1=false;this.data.dnd.to2=false;this.data.dnd.active=false;this.data.dnd.foreign=false;f&&f.css({top:"-2000px"})},this)).bind("drag_start.vakata",c.proxy(function(i,l){if(l.data.jstree){var j=c(l.event.target);j.closest(".jstree").hasClass("jstree-"+
this.get_index())&&this.dnd_enter(j)}},this));var h=this._get_settings().dnd;h.drag_target&&c(document).delegate(h.drag_target,"mousedown.jstree",c.proxy(function(i){a=i.target;c.vakata.dnd.drag_start(i,{jstree:true,obj:i.target},"<ins class='jstree-icon'></ins>"+c(i.target).text());if(this.data.themes){f.attr("class","jstree-"+this.data.themes.theme);c.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}c.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");
i=this.get_container();this.data.dnd.cof=i.offset();this.data.dnd.cw=parseInt(i.width(),10);this.data.dnd.ch=parseInt(i.height(),10);this.data.dnd.foreign=true;return false},this));h.drop_target&&c(document).delegate(h.drop_target,"mouseenter.jstree",c.proxy(function(i){this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:a,r:c(i.target)})&&c.vakata.dnd.helper.children("ins").attr("class","jstree-ok")},this)).delegate(h.drop_target,"mouseleave.jstree",c.proxy(function(){this.data.dnd.active&&
c.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")},this)).delegate(h.drop_target,"mouseup.jstree",c.proxy(function(i){this.data.dnd.active&&c.vakata.dnd.helper.children("ins").hasClass("jstree-ok")&&this._get_settings().dnd.drop_finish.call(this,{o:a,r:c(i.target)})},this))},defaults:{copy_modifier:"ctrl",check_timeout:200,open_timeout:500,drop_target:".jstree-drop",drop_check:function(){return true},drop_finish:c.noop,drag_target:".jstree-draggable",drag_finish:c.noop,drag_check:function(){return{after:false,
before:false,inside:true}}},_fn:{dnd_prepare:function(){if(e&&e.length){this.data.dnd.off=e.offset();if(this._get_settings().core.rtl)this.data.dnd.off.right=this.data.dnd.off.left+e.width();if(this.data.dnd.foreign){var h=this._get_settings().dnd.drag_check.call(this,{o:a,r:e});this.data.dnd.after=h.after;this.data.dnd.before=h.before;this.data.dnd.inside=h.inside;this.data.dnd.prepared=true;return this.dnd_show()}this.prepare_move(a,e,"before");this.data.dnd.before=this.check_move();this.prepare_move(a,
e,"after");this.data.dnd.after=this.check_move();if(this._is_loaded(e)){this.prepare_move(a,e,"inside");this.data.dnd.inside=this.check_move()}else this.data.dnd.inside=false;this.data.dnd.prepared=true;return this.dnd_show()}},dnd_show:function(){if(this.data.dnd.prepared){var h=["before","inside","after"],i=false,l=this._get_settings().core.rtl;h=this.data.dnd.w<this.data.core.li_height/3?["before","inside","after"]:this.data.dnd.w<=this.data.core.li_height*2/3?this.data.dnd.w<this.data.core.li_height/
2?["inside","before","after"]:["inside","after","before"]:["after","inside","before"];c.each(h,c.proxy(function(j,m){if(this.data.dnd[m]){c.vakata.dnd.helper.children("ins").attr("class","jstree-ok");i=m;return false}},this));i===false&&c.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");h=l?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(i){case "before":f.css({left:h+"px",top:this.data.dnd.off.top-6+"px"}).show();break;case "after":f.css({left:h+"px",top:this.data.dnd.off.top+
this.data.core.li_height-7+"px"}).show();break;case "inside":f.css({left:h+(l?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show();break;default:f.hide()}return i}},dnd_open:function(){this.data.dnd.to2=false;this.open_node(e,c.proxy(this.dnd_prepare,this),true)},dnd_finish:function(h){if(this.data.dnd.foreign){if(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside)this._get_settings().dnd.drag_finish.call(this,{o:a,r:e})}else{this.dnd_prepare();this.move_node(a,
e,this.dnd_show(),h[this._get_settings().dnd.copy_modifier+"Key"])}e=a=false;f.hide()},dnd_enter:function(h){var i=this._get_settings().dnd;this.data.dnd.prepared=false;e=this._get_node(h);if(i.check_timeout){this.data.dnd.to1&&clearTimeout(this.data.dnd.to1);this.data.dnd.to1=setTimeout(c.proxy(this.dnd_prepare,this),i.check_timeout)}else this.dnd_prepare();if(i.open_timeout){this.data.dnd.to2&&clearTimeout(this.data.dnd.to2);if(e&&e.length&&e.hasClass("jstree-closed"))this.data.dnd.to2=setTimeout(c.proxy(this.dnd_open,
this),i.open_timeout)}else e&&e.length&&e.hasClass("jstree-closed")&&this.dnd_open()},start_drag:function(h,i){a=this._get_node(h);if(this.data.ui&&this.is_selected(a))a=this._get_node(null,true);c.vakata.dnd.drag_start(i,{jstree:true,obj:a},"<ins class='jstree-icon'></ins>"+(a.length>1?"Multiple selection":this.get_text(a)));if(this.data.themes){f.attr("class","jstree-"+this.data.themes.theme);c.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}var l=this.get_container();
this.data.dnd.cof=l.children("ul").offset();this.data.dnd.cw=parseInt(l.width(),10);this.data.dnd.ch=parseInt(l.height(),10);this.data.dnd.active=true}}});c(function(){c.vakata.css.add_sheet({str:"#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; line-height:12px; font-size:1px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:silver; } "});
f=c("<div>").attr({id:"jstree-marker"}).hide().appendTo("body");c(document).bind("drag_start.vakata",function(h,i){i.data.jstree&&f.show()});c(document).bind("drag_stop.vakata",function(h,i){i.data.jstree&&f.hide()})})})(jQuery);
(function(c){c.expr[":"].jstree_contains=function(a,e,f){return(a.textContent||a.innerText||"").toLowerCase().indexOf(f[3].toLowerCase())>=0};c.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=c()},defaults:{ajax:false,case_insensitive:false},_fn:{search:function(a,e){if(a!==""){var f=this.get_settings().search,g=this,k=function(){},b=function(){};this.data.search.str=a;if(!e&&f.ajax!==false&&this.get_container().find(".jstree-closed:eq(0)").length>0){this.search.supress_callback=
true;k=function(){};b=function(d,h,i){var l=this.get_settings().search.ajax.success;if(l)d=l.call(this,d,h,i)||d;this.data.search.to_open=d;this._search_open()};f.ajax.context=this;f.ajax.error=k;f.ajax.success=b;if(c.isFunction(f.ajax.url))f.ajax.url=f.ajax.url.call(this,a);if(c.isFunction(f.ajax.data))f.ajax.data=f.ajax.data.call(this,a);if(!f.ajax.data)f.ajax.data={search_string:a};if(!f.ajax.dataType||/^json/.exec(f.ajax.dataType))f.ajax.dataType="json";c.ajax(f.ajax)}else{this.data.search.result.length&&
this.clear_search();this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+(f.case_insensitive?"jstree_contains":"contains")+"("+this.data.search.str+")");this.data.search.result.addClass("jstree-search").parents(".jstree-closed").each(function(){g.open_node(this,false,true)});this.__callback({nodes:this.data.search.result,str:a})}}},clear_search:function(){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);
this.data.search.result=c()},_search_open:function(){var a=this,e=true,f=[],g=[];if(this.data.search.to_open.length){c.each(this.data.search.to_open,function(k,b){if(b=="#")return true;c(b).length&&c(b).is(".jstree-closed")?f.push(b):g.push(b)});if(f.length){this.data.search.to_open=g;c.each(f,function(k,b){a.open_node(b,function(){a._search_open(true)})});e=false}}e&&this.search(this.data.search.str,true)}}})})(jQuery);
(function(c){c.vakata.context={cnt:c("<div id='vakata-contextmenu'>"),vis:false,tgt:false,par:false,func:false,data:false,show:function(a,e,f,g,k,b){if(a=c.vakata.context.parse(a)){c.vakata.context.vis=true;c.vakata.context.tgt=e;c.vakata.context.par=b||e||null;c.vakata.context.data=k||null;c.vakata.context.cnt.html(a).css({visibility:"hidden",display:"block",left:0,top:0});k=c.vakata.context.cnt.height();b=c.vakata.context.cnt.width();if(f+b>c(document).width()){f=c(document).width()-(b+5);c.vakata.context.cnt.find("li > ul").addClass("right")}if(g+
k>c(document).height()){g-=k+e[0].offsetHeight;c.vakata.context.cnt.find("li > ul").addClass("bottom")}c.vakata.context.cnt.css({left:f,top:g}).find("li:has(ul)").bind("mouseenter",function(){var d=c(document).width(),h=c(document).height(),i=c(this).children("ul").show();d!==c(document).width()&&i.toggleClass("right");h!==c(document).height()&&i.toggleClass("bottom")}).bind("mouseleave",function(){c(this).children("ul").hide()}).end().css({visibility:"visible"}).show();c(document).triggerHandler("context_show.vakata")}},
hide:function(){c.vakata.context.vis=false;c.vakata.context.cnt.attr("class","").hide();c(document).triggerHandler("context_hide.vakata")},parse:function(a,e){if(!a)return false;var f="",g=false,k=true;if(!e)c.vakata.context.func={};f+="<ul>";c.each(a,function(b,d){if(!d)return true;c.vakata.context.func[b]=d.action;if(!k&&d.separator_before)f+="<li class='vakata-separator vakata-separator-before'></li>";k=false;f+="<li class='"+(d._class||"")+(d._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";
if(d.icon&&d.icon.indexOf("/")===-1)f+=" class='"+d.icon+"' ";if(d.icon&&d.icon.indexOf("/")!==-1)f+=" style='background:url("+d.icon+") center center no-repeat;' ";f+=">&#160;</ins><a href='#' rel='"+b+"'>";if(d.submenu)f+="<span style='float:right;'>&raquo;</span>";f+=d.label+"</a>";if(d.submenu)if(g=c.vakata.context.parse(d.submenu,true))f+=g;f+="</li>";if(d.separator_after){f+="<li class='vakata-separator vakata-separator-after'></li>";k=true}});f=f.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,
"");f+="</ul>";return f.length>10?f:false},exec:function(a){if(c.isFunction(c.vakata.context.func[a])){c.vakata.context.func[a].call(c.vakata.context.data,c.vakata.context.par);return true}else return false}};c(function(){c.vakata.css.add_sheet({str:"#vakata-contextmenu { display:none; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } "});
c.vakata.context.cnt.delegate("a","click",function(a){a.preventDefault()}).delegate("a","mouseup",function(){!c(this).parent().hasClass("jstree-contextmenu-disabled")&&c.vakata.context.exec(c(this).attr("rel"))?c.vakata.context.hide():c(this).blur()}).delegate("a","mouseover",function(){c.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");c(document).bind("mousedown",function(a){c.vakata.context.vis&&!c.contains(c.vakata.context.cnt[0],a.target)&&c.vakata.context.hide()});
typeof c.hotkeys!=="undefined"&&c(document).bind("keydown","up",function(a){if(c.vakata.context.vis){var e=c.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();e.length||(e=c.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last());e.addClass("vakata-hover");a.stopImmediatePropagation();a.preventDefault()}}).bind("keydown","down",function(a){if(c.vakata.context.vis){var e=
c.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();e.length||(e=c.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first());e.addClass("vakata-hover");a.stopImmediatePropagation();a.preventDefault()}}).bind("keydown","right",function(a){if(c.vakata.context.vis){c.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover");
a.stopImmediatePropagation();a.preventDefault()}}).bind("keydown","left",function(a){if(c.vakata.context.vis){c.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover");a.stopImmediatePropagation();a.preventDefault()}}).bind("keydown","esc",function(a){c.vakata.context.hide();a.preventDefault()}).bind("keydown","space",function(a){c.vakata.context.cnt.find(".vakata-hover").last().children("a").click();a.preventDefault()})});c.jstree.plugin("contextmenu",
{__init:function(){this.get_container().delegate("a","contextmenu.jstree",c.proxy(function(a){a.preventDefault();this.show_contextmenu(a.currentTarget,a.pageX,a.pageY)},this)).bind("destroy.jstree",c.proxy(function(){this.data.contextmenu&&c.vakata.context.hide()},this));c(document).bind("context_hide.vakata",c.proxy(function(){this.data.contextmenu=false},this))},defaults:{select_node:false,show_at_node:true,items:{create:{separator_before:false,separator_after:true,label:"Create",action:function(a){this.create(a)}},
rename:{separator_before:false,separator_after:false,label:"Rename",action:function(a){this.rename(a)}},remove:{separator_before:false,icon:false,separator_after:false,label:"Delete",action:function(a){this.remove(a)}},ccp:{separator_before:true,icon:false,separator_after:false,label:"Edit",action:false,submenu:{cut:{separator_before:false,separator_after:false,label:"Cut",action:function(a){this.cut(a)}},copy:{separator_before:false,icon:false,separator_after:false,label:"Copy",action:function(a){this.copy(a)}},
paste:{separator_before:false,icon:false,separator_after:false,label:"Paste",action:function(a){this.paste(a)}}}}}},_fn:{show_contextmenu:function(a,e,f){a=this._get_node(a);var g=this.get_settings().contextmenu,k=a.children("a:visible:eq(0)"),b=false;if(g.select_node&&this.data.ui&&!this.is_selected(a)){this.deselect_all();this.select_node(a,true)}if(g.show_at_node||typeof e==="undefined"||typeof f==="undefined"){b=k.offset();e=b.left;f=b.top+this.data.core.li_height}if(c.isFunction(g.items))g.items=
g.items.call(this,a);this.data.contextmenu=true;c.vakata.context.show(g.items,k,e,f,this,a);this.data.themes&&c.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}})})(jQuery);
(function(c){c.jstree.plugin("types",{__init:function(){var a=this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",c.proxy(function(){var e=a.type_attr,f="",g=this;c.each(a.types,function(k,b){c.each(b,function(d){/^(max_depth|max_children|icon|valid_children)$/.test(d)||g.data.types.attach_to.push(d)});if(!b.icon)return true;if(b.icon.image||b.icon.position){f+=k=="default"?".jstree-"+g.get_index()+" a > .jstree-icon { ":".jstree-"+g.get_index()+" li["+
e+"="+k+"] > a > .jstree-icon { ";if(b.icon.image)f+=" background-image:url("+b.icon.image+"); ";f+=b.icon.position?" background-position:"+b.icon.position+"; ":" background-position:0 0; ";f+="} "}});f!=""&&c.vakata.css.add_sheet({str:f})},this)).bind("before.jstree",c.proxy(function(e,f){if(c.inArray(f.func,this.data.types.attach_to)!==-1){var g=this._get_settings().types.types,k=this._get_type(f.args[0]);if((g[k]&&typeof g[k][f.func]!=="undefined"||g["default"]&&typeof g["default"][f.func]!=="undefined")&&
!this._check(f.func,f.args[0])){e.stopImmediatePropagation();return false}}},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_get_type:function(a){a=this._get_node(a);return!a||!a.length?false:a.attr(this._get_settings().types.type_attr)||"default"},set_type:function(a,e){e=this._get_node(e);return!e.length||!a?false:e.attr(this._get_settings().types.type_attr,a)},_check:function(a,e,f){var g=
false,k=this._get_type(e),b=0,d=this,h=this._get_settings().types;if(e===-1)if(h[a])g=h[a];else return;else{if(k===false)return;if(h.types[k]&&h.types[k][a])g=h.types[k][a];else if(h.types["default"]&&h.types["default"][a])g=h.types["default"][a]}if(c.isFunction(g))g=g.call(this,e);a==="max_depth"&&e!==-1&&f!==false&&h.max_depth!==-2&&g!==0&&this._get_node(e).children("a:eq(0)").parentsUntil(".jstree","li").each(function(i){if(h.max_depth!==-1&&h.max_depth-(i+1)<=0){g=0;return false}b=i===0?g:d._check(a,
this,false);if(b!==-1&&b-(i+1)<=0){g=0;return false}if(b>=0&&(b-(i+1)<g||g<0))g=b-(i+1);if(h.max_depth>=0&&(h.max_depth-(i+1)<g||g<0))g=h.max_depth-(i+1)});return g},check_move:function(){if(!this.__call_old())return false;var a=this._get_move(),e=a.rt._get_settings().types,f=a.rt._check("max_children",a.cr),g=a.rt._check("max_depth",a.cr),k=a.rt._check("valid_children",a.cr),b=0,d=1;if(k==="none")return false;if(c.isArray(k)&&a.ot&&a.ot._get_type){a.o.each(function(){if(c.inArray(a.ot._get_type(this),
k)===-1)return d=false});if(d===false)return false}if(e.max_children!==-2&&f!==-1){b=a.cr===-1?this.get_container().children("> ul > li").not(a.o).length:a.cr.children("> ul > li").not(a.o).length;if(b+a.o.length>f)return false}if(e.max_depth!==-2&&g!==-1){d=0;if(g===0)return false;if(typeof a.o.d==="undefined"){for(e=a.o;e.length>0;){e=e.find("> ul > li");d++}a.o.d=d}if(g-a.o.d<0)return false}return true},create_node:function(a,e,f,g,k,b){if(!b&&(k||this._is_loaded(a))){var d=e&&e.match(/^before|after$/i)&&
a!==-1?this._get_parent(a):this._get_node(a),h=this._get_settings().types,i=this._check("max_children",d),l=this._check("max_depth",d),j=this._check("valid_children",d);f||(f={});if(j==="none")return false;if(c.isArray(j))if(!f.attr||!f.attr[h.type_attr]){if(!f.attr)f.attr={};f.attr[h.type_attr]=j[0]}else if(c.inArray(f.attr[h.type_attr],j)===-1)return false;if(h.max_children!==-2&&i!==-1){d=d===-1?this.get_container().children("> ul > li").length:d.children("> ul > li").length;if(d+1>i)return false}if(h.max_depth!==
-2&&l!==-1&&l-1<0)return false}return this.__call_old(true,a,e,f,g,k,b)}}})})(jQuery);
(function(c){c.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",c.proxy(function(a,e){var f=[],g=true,k;if(e.func=="move_node")if(e.args[4]===true)if(e.args[0].o&&e.args[0].o.length){e.args[0].o.children("a").each(function(){f.push(c(this).text().replace(/^\s+/g,""))});g=this._check_unique(f,e.args[0].np.find("> ul > li").not(e.args[0].o))}if(e.func=="create_node")if(e.args[4]||this._is_loaded(e.args[0])){g=this._get_node(e.args[0]);if(e.args[1]&&(e.args[1]==="before"||
e.args[1]==="after")){g=this._get_parent(e.args[0]);if(!g||g===-1)g=this.get_container()}if(typeof e.args[2]==="string")f.push(e.args[2]);else!e.args[2]||!e.args[2].data?f.push(this._get_settings().core.strings.new_node):f.push(e.args[2].data);g=this._check_unique(f,g.find("> ul > li"))}if(e.func=="rename_node"){f.push(e.args[1]);k=this._get_node(e.args[0]);g=this._get_parent(k);if(!g||g===-1)g=this.get_container();g=this._check_unique(f,g.find("> ul > li").not(k))}if(!g){a.stopPropagation();return false}},
this))},_fn:{_check_unique:function(a,e){var f=[];e.children("a").each(function(){f.push(c(this).text().replace(/^\s+/g,""))});if(!f.length||!a.length)return true;f=f.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");if(f.length+a.length!=f.concat(a).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length)return false;return true},check_move:function(){if(!this.__call_old())return false;
var a=this._get_move(),e=[];if(a.o&&a.o.length){a.o.children("a").each(function(){e.push(c(this).text().replace(/^\s+/g,""))});return this._check_unique(e,a.np.find("> ul > li").not(a.o))}return true}}})})(jQuery);
